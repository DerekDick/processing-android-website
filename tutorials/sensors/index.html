<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather:300">
        <link rel="icon" type="image/png" href="http://android.processing.org/test/favicon.png">
        <link rel="stylesheet" href="../../css/main.css">
        <title>Processing for Android</title>
    </head>
    
    <body>

        <nav class="ring">        
            <ul class="left">
                <li><a href="https://processing.org/">Processing</a></li>
                <li><a href="http://p5js.org/">p5.js</a></li>
                <li><a href="http://py.processing.org/">Processing.py</a></li>
                <li class="highlight"><a href="http://android.processing.org/test/">Processing for Android</a></li>
            </ul>
            <ul class="right">
                <li><a href="https://processingfoundation.org/">Processing Foundation</a></li>
            </ul>
        </nav>   

        <header>            
            <h1 class="title">Processing for Android</h1>
        </header>

        <div class="group">

            <nav class="site">
                <img class="logo" src="../../imgs/logo.png" alt="Processing for Android logo"><br><br><br><br>
                <a href="../../index.html">Home</a><br>
                <a href="../../install.html">Install</a><br>
                <a href="../../libraries.html">Libraries</a><br>
                <a href="../../reference.html">Reference</a><br>
                <a id="selected" href="../index.html">Tutorials</a><br> 
                <a href="https://forum.processing.org/two/categories/android" target="_black">Forum</a><br>
                <a href="https://github.com/processing/processing-android" target="_black">GitHub</a><br>
            </nav>
      
            <section class="container main-text">
            	<h2>Using the sensors</h2>
                <p>                
                How to access accelerometer, GPS, compass, etc.
                </p>

                <h3>Sensor API in the Android SDK</h3>
                
                <p>
                Smartphones and tablets include many different sensors, for example accelerometers, gyroscopes, magnetic field sensors, and barometers, which allow to collect information about the movement and location of the device, and about its surroundings. Wearable devices (smartwatches, fitness bands)also incorporate sensors that can take bodily, like heartrate and fingerprints.</p>
                <p>While the Processing language does not offer specialized functions to read data from these sensors sensors, you can import the packages in the <a href="https://developer.android.com/reference/android/hardware/Sensor.html">Android SDK</a> that allow collect sensor measurements from your sketch. 
                </p>

                <h3>Creating a sensor manager</h3>
                <p>
                The first step to use the sensor API is to obtain the cntext of the activity that contains the sketch, and use this activity to initialize the sensor manager that we will use to 
                Once the sketch starts and calls the setup() function, we can grab the context of the activity that contains the
                sketch, and using it to initialize the sensor manager that we will use the sensor and the "listener" object that will allow us to listen to the sensor from our sketch:
                </p>

<pre><code>
<span style="color: #33997E;">import</span> android.content.Context;
<span style="color: #33997E;">import</span> android.hardware.Sensor;
<span style="color: #33997E;">import</span> android.hardware.SensorEvent;
<span style="color: #33997E;">import</span> android.hardware.SensorEventListener;
<span style="color: #33997E;">import</span> android.hardware.SensorManager;

Context&nbsp;context;
SensorManager&nbsp;sensorManager;

<span style="color: #33997E;">void</span> <span style="color: #006699;"><b>setup</b></span>() {
&nbsp;&nbsp;<span style="color: #006699;">fullScreen</span>(<span style="color: #718A62;">P3D</span>);
&nbsp;&nbsp;
&nbsp;&nbsp;context&nbsp;=&nbsp;getActivity();
&nbsp;&nbsp;sensorManager&nbsp;=&nbsp;(SensorManager)context.getSystemService(Context.SENSOR_SERVICE);
}

<span style="color: #33997E;">void</span> <span style="color: #006699;"><b>draw</b></span>() {

}
</code></pre>

                <h3>Sensor event listener</h3>
                <p>
                Now we implement a "listener" class that will notify the sketch that new data is coming from the sensor. A listener for each sensor is derived using the base SensorEventListener class from the Android SDK:
                </p>

<pre><code>
<span style="color: #33997E;">import</span> android.content.Context;
<span style="color: #33997E;">import</span> android.hardware.Sensor;
<span style="color: #33997E;">import</span> android.hardware.SensorEvent;
<span style="color: #33997E;">import</span> android.hardware.SensorEventListener;
<span style="color: #33997E;">import</span> android.hardware.SensorManager;

Context&nbsp;context;
SensorManager&nbsp;sensorManager;
MySensorEventListener&nbsp;listener;

<span style="color: #33997E;">void</span> <span style="color: #006699;"><b>setup</b></span>() {
&nbsp;&nbsp;<span style="color: #006699;">fullScreen</span>(<span style="color: #718A62;">P3D</span>);
&nbsp;&nbsp;
&nbsp;&nbsp;context&nbsp;=&nbsp;getActivity();
&nbsp;&nbsp;sensorManager&nbsp;=&nbsp;(SensorManager)context.getSystemService(Context.SENSOR_SERVICE);

&nbsp;&nbsp;listener&nbsp;=&nbsp;<span style="color: #33997E;">new</span> MySensorEventListener();                    
}

<span style="color: #33997E;">void</span> <span style="color: #006699;"><b>draw</b></span>() {

}

<span style="color: #33997E;">class</span> MySensorEventListener <span style="color: #33997E;">implements</span> SensorEventListener {
&nbsp;&nbsp;<span style="color: #33997E;">public</span> <span style="color: #33997E;">void</span> onSensorChanged(SensorEvent event) {                  
&nbsp;&nbsp;&nbsp;&nbsp;accValues&nbsp;=&nbsp;event.values;
&nbsp;&nbsp;}
&nbsp;&nbsp;<span style="color: #33997E;">public</span> <span style="color: #33997E;">void</span> onAccuracyChanged(Sensor sensor, <span style="color: #E2661A;">int</span> accuracy) {
&nbsp;&nbsp;}
}
</code></pre>

                <h3>Getting the sensor data</h3>
                <p>
                Once the event listener is ready, we create the sensor and pass it to the listener:
                </p>    

<pre><code>
<span style="color: #33997E;">import</span> android.content.Context;
<span style="color: #33997E;">import</span> android.hardware.Sensor;
<span style="color: #33997E;">import</span> android.hardware.SensorEvent;
<span style="color: #33997E;">import</span> android.hardware.SensorEventListener;
<span style="color: #33997E;">import</span> android.hardware.SensorManager;

Context&nbsp;context;
SensorManager&nbsp;sensorManager;
MySensorEventListener&nbsp;listener;
Sensor&nbsp;accSensor;
<span style="color: #E2661A;">float</span> x, y, z;

<span style="color: #33997E;">void</span> <span style="color: #006699;"><b>setup</b></span>() {
&nbsp;&nbsp;<span style="color: #006699;">fullScreen</span>(<span style="color: #718A62;">P3D</span>);
&nbsp;&nbsp;
&nbsp;&nbsp;context&nbsp;=&nbsp;getActivity();
&nbsp;&nbsp;sensorManager&nbsp;=&nbsp;(SensorManager)context.getSystemService(Context.SENSOR_SERVICE);

&nbsp;&nbsp;listener&nbsp;=&nbsp;<span style="color: #33997E;">new</span> MySensorEventListener();  
&nbsp;&nbsp;accSensor&nbsp;=&nbsp;sensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
&nbsp;&nbsp;sensorManager.registerListener(listener,&nbsp;accSensor,&nbsp;SensorManager.SENSOR_DELAY_GAME);
}

<span style="color: #33997E;">void</span> <span style="color: #006699;"><b>draw</b></span>() {

}

<span style="color: #33997E;">class</span> MySensorEventListener <span style="color: #33997E;">implements</span> SensorEventListener {
&nbsp;&nbsp;<span style="color: #33997E;">public</span> <span style="color: #33997E;">void</span> onSensorChanged(SensorEvent event) {                  
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;event.values[0];
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;=&nbsp;event.values[1];
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;event.values[2];
&nbsp;&nbsp;}
&nbsp;&nbsp;<span style="color: #33997E;">public</span> <span style="color: #33997E;">void</span> onAccuracyChanged(Sensor sensor, <span style="color: #E2661A;">int</span> accuracy) {
&nbsp;&nbsp;}
}&nbsp;&nbsp;&nbsp;
 
</code></pre>

                <div class="butterbar">
                In version 4.0, getActivity() needs to be called from the surface object available in PApplet: 
                <pre> 
                context = surface.getActivity();
                </pre>
                </div>

                <p>
                In this case, the data from the accelerometer will be stored in the accValues array, for x, y, and z. We can
                use these values in the draw() function:
                </p>

<pre><code>
<span style="color: #33997E;">void</span> <span style="color: #006699;"><b>draw</b></span>() {
&nbsp;&nbsp;<span style="color: #006699;">background</span>(157);
&nbsp;&nbsp;<span style="color: #006699;">lights</span>();
&nbsp;&nbsp;<span style="color: #006699;">translate</span>(x, y, z);
&nbsp;&nbsp;<span style="color: #006699;">sphere</span>(50);
}&nbsp;&nbsp;
</code></pre>

                <h3>Accessing other sensors</h3>

                <p>Other sensors can be accessed in a very similary way, all you need to check Google's documentation and examples to use the correct classes and interpret the sensor values.</p>
                <p>You could also use the <a href="http://ketai.org/">Ketai library</a> from Daniel Sauter and Jesus Duran, which wraps all of this handling code and makes very easy to simple obtain sensor values. Ketai can be installed through the Contribution manager.</p>

            </section>

        </div>

        <footer class="container">
            <small>&copy; The Processing Foundation. Processing for Android is a <a href="../../team.html">collaborative project</a>.</small>
        </footer>
    </body>
</html>

